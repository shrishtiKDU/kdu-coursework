<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>promises handson with xhr</title>
</head>
<body>
    <button id="fetch-data">click me </button>
    <div id="output"></div>
    <script>
        let api1='https://jsonplaceholder.typicode.com/posts/1';
        let api2='https://jsonplaceholder.typicode.com/posts/2';
        function makeApiCall(url){
            return new Promise((resolve,reject)=>{
                const xhr=new XMLHttpRequest();
                xhr.open('GET', url,true);
            function onResponse(){
                 if(xhr.status===200){
                    let responseData=JSON.parse(xhr.responseText);
                    resolve(responseData);
                  }
                 else{
                    var error=new Error("request failed with status: "+xhr.status);
                    reject(error);
                  }
              }
            function onError(){
                let error=new Error("error making the api call");
                throw error;
            }
            xhr.onload=onResponse;
            xhr.onerror=onError;
            xhr.send();
            });
        }
        function buttonClickHandler(){
            // makeApiCall().then(postData=>{
            //     console.log("api call executed");
            //     displayData(postData);
            // }).catch(error);
        Promise.any([makeApiCall(api1),makeApiCall(api2)]).then((response1)=>{
            console.log("worked successfully");
            displayData(response1);
            displayData(response2);
        }).catch(()=>{
            console.log("didn't worked");
        });
        }
        function displayData(data){
            const outputDiv=document.getElementById("output");
            outputDiv.innerText=JSON.stringify(data);
        }
        // Promise.all([makeApiCall(api1),makeApiCall(api2)]).then(([response1,response2])=>{
        //     console.log("worked successfully");
        //     displayData(response1);
        //     displayData(response2);
        // }).catch(()=>{
        //     console.log("didn't worked");
        // });
        document.getElementById("fetch-data").addEventListener("click",buttonClickHandler);
    </script>
</body>
</html>








